<div class="view-container">
  <div class="header-products-view">
    <h2>Dulce Creams</h2>
    <span class="total-label">
    <strong>Total:</strong> {{ productsSelected() | totalPrice }}
  </span>
  </div>

  <div class="products-container" *ngIf="products()?.length">
    @for (product of productsList(); track product.id) {
        <mat-card
          class="product-card"
          [ngClass]="{ 'product-selected': product | validProductsSelected: productsSelected() }"
          (click)="selected(product)"
        >
          <img ngSrc="{{product.product_image}}" class="product-image" width="150" height="250"
               alt="{{product.product_name}}"/>
          <mat-card-content>
            <h3 class="product-name">{{ product.product_name }}</h3>
            <p class="product-description">{{ product.product_description }}</p>
            <div class="product-price">$ {{ product.product_price }}</div>

            <!-- Cantidad -->
            <div class="quantity-selector" (click)="$event.stopPropagation()">
              <button (click)="decrement(product)">âˆ’</button>
              <input type="number" [value]="product | countProduct: productsSelected()" min="1" />
              <button (click)="increment(product)">+</button>
            </div>
            <!-- Toppings opcionales -->
            <div class="toppings" (click)="$event.stopPropagation()">
              @for (top of product.toppings; track top.name; let i = $index) {
                <mat-checkbox [disabled]="!(product | validProductsSelected: productsSelected())"
                              (change)="selectTopping($event, product.id, top)" >{{top.name}} </mat-checkbox>
              }
            </div>
          </mat-card-content>
          <div class="container-other-buttons" (click)="$event.stopPropagation()">
            <button mat-raised-button class="other-product-button"
                    *ngIf="!(product | validProductsSelected: products() ?? [])"
                    (click)="remove(product)">
              <mat-icon class="material-icons color-red">delete</mat-icon> <span class="color-red">Remover</span></button>
            <button mat-flat-button class="other-product-button"
                    [disabled]="!(product | validProductsSelected: productsSelected())"
                    (click)="$event.stopPropagation(); addOther(product)">
              <mat-icon class="material-icons">add_circle</mat-icon> Agregar
            </button>
          </div>

        </mat-card>
    }
  </div>

  <div class="cancel-button-container">
    <p class="quantity-selected">
      Total Pedidos: {{productsSelected().length || 0}} </p>
    <div>
      <button class="margin-2-px" mat-stroked-button (click)="goBack.emit()">Cancelar</button>
      <button class="margin-2-px" mat-flat-button [disabled]="!productsSelected().length"
              (click)="sendOrder()">Hacer Pedido</button>
    </div>
  </div>
</div>















